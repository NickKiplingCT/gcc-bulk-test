{"icon":"white","settings":{"router":{"mode":"single","animation":"off"},"theme":"default","push-notifications":{"android":{"enabled":false},"ios":{"enabled":false},"wp":{"enabled":false}},"auth":false},"name":"GCCBulkUplift","version":"1.1","pages":[{"start":true,"name":"Splash","config":[{"name":"On-Load Event","type":"event","item-type":"onload","actions":[{"name":"inline_function_1","event":"onload","type":"inline-function","data":{"code":"// Fake data:\n\nvar jobList = [\n  { name: \"Mrs E Holmes\", address: \"15 Finley Drive, Glasgow, G31 2QU\", phone: \"01415 560 206\" },\n  { name: \"Mrs J Jones\", address: \"32 Elm Grove, Glasgow, G32 5DR\", phone: \"07854 254 123\" },\n  { name: \"Mr D Williams\", address: \"4 Station Approach, Glasgow, G22 1PR\", phone: \"07790 118 233\" },\n  { name: \"Mr W Rogers\", address: \"74 Plasforth Place, Glasgow, G22 1DS\", phone: \"01415 896 332\" },\n  { name: \"Mr A McPeake\", address: \"74 Plasforth Place, Glasgow, G22 1DS\", phone: \"01415 896 332\" },\n  { name: \"Mr R Bourne\", address: \"74 Plasforth Place, Glasgow, G22 1DS\", phone: \"01415 896 332\" },\n  { name: \"Miss S Raisen\", address: \"74 Plasforth Place, Glasgow, G22 1DS\", phone: \"01415 896 332\" }\n];\n\nmdm.store.data__.jobList = jobList;\nmdm.store.data__.remainingJobCount = jobList.length;\nmdm.store.data__.completedJobs = [];\ndelete mdm.store.data__.currentJob;"}}]}],"content":[{"name":"staticSplash","type":"area","item-type":"static","content":[{"name":"imgLogo","type":"media","item-type":"image","actions":[],"expressions":{},"fileName":"Glasgow-City-Council-logo-small-3.png"},{"name":"htmlContainer","type":"content","item-type":"html","content":"<h2>Bulk<br>Uplift</h2>","expressions":{}},{"name":"btnStart","type":"control","item-type":"button","content":"Start","theme":"default","actions":[{"name":"call_api_1","event":"click","type":"call-api","data":{"name":"bulkUplift","operation":"getNeighbourhoods"},"actions":[{"name":"go_to_page_1","event":"success","type":"go-to-page","data":"PatchSelect"}]}],"expressions":{}}],"expressions":{}},{"name":"staticDescription","type":"area","item-type":"static","content":[{"name":"htmlDescription","type":"content","item-type":"html","content":"<p>Helping manage your daily bulk uplift tasks with image capture and feedback.</p>","expressions":{}}],"expressions":{}}]},{"name":"JobList","config":[{"name":"On-Load Event","type":"event","item-type":"onload","actions":[{"name":"inline_function_1","event":"onload","type":"inline-function","data":{"code":"setTimeout(function() {\n  if(mdm.store.data__.api.bulkUplift.getJobs.length == 0) {\n    var popup = document.getElementById('allComplete');\n    popup.togglePopup();\n  }\n}, 200);"}}]}],"content":[{"name":"titleJobsList","type":"navigation","item-type":"title-bar","content":[{"name":"btnMenu","type":"control","item-type":"button","content":"","theme":"default","right-icon":"fa-bars","expressions":{},"actions":[{"name":"call_function_1","event":"click","type":"call-function","data":{"name":"openContextMenu"}}]}],"extends":{"type":"area","item-type":"row"},"expressions":{}},{"name":"staticJobsOverview","type":"area","item-type":"static","content":[{"name":"htmlOverview","type":"content","item-type":"html","content":"<h2>Current Batch</h2>\n\n<div class=\"box\">\n  <h3><span>{{'data__.completedJobs.length' | store}}</span><br>Completed</h3>\n</div>\n\n<div class=\"box\">\n  <h3><span>{{'data__.currentJob !== undefined ? data__.api.bulkUplift.getJobs.length + 1 : data__.api.bulkUplift.getJobs.length' | store}}</span><br>Remaining</h3>\n</div>\n\n<div class=\"box btn\" md-actions='[{\"name\":\"go_to_page_1\",\"event\":\"click\",\"type\":\"go-to-page\",\"data\":\"RequestJobs\"}]'>\n  <h3>Request Additional Jobs</h3>\n</div>","expressions":{}}],"expressions":{}},{"name":"scrollableLaterToday","type":"area","item-type":"scrollable","content":[{"name":"htmlCurrentJob","type":"content","item-type":"html","content":"<h2>Current Job</h2>\n\n<div class=\"jobRow borderTop\">\n  <div class=\"jobCell location\">\n    <p></p>\n  </div>\n  \n  <div class=\"jobCell address\">\n    <p class=\"name\">{{'data__.currentJob.CustomerName' | store}}</p>\n    <p>{{'data__.currentJob.SingleLineAddress' | store}}</p>\n    <p class=\"contact\">{{'data__.currentJob.Phone' | store}}<p>\n  </div>\n  \n  <div class=\"jobCell btn\" md-actions='[{\"name\":\"go_to_page_1\",\"event\":\"click\",\"type\":\"go-to-page\",\"data\":\"JobDetail\"}]'>\n    <p></p>\n  </div>\n</div>","expressions":{"show":"data__.currentJob"}},{"name":"htmlLaterToday","type":"content","item-type":"html","content":"<h2>Your Jobs</h2>","expressions":{"show":"data__.api.bulkUplift.getJobs.length > 0"}},{"name":"lstJobs","type":"content","item-type":"list","title":"List","edit":false,"search":false,"row":"<div class=\"jobRow\">\n  <div class=\"jobCell location\">\n    <p></p>\n  </div>\n  \n  <div class=\"jobCell address\">\n    <p class=\"name\">{{$item.CustomerName}}</p>\n    <p>{{$item.SingleLineAddress}}</p>\n    <p class=\"contact\">{{$item.Phone}}<p>\n  </div>\n  \n  <div class=\"jobCell btn\">\n    <p></p>\n  </div>\n</div>","classes":"","expressions":{},"actions":[{"name":"call_function_1","event":"click","type":"call-function","data":{"name":"setCurrentJob","params":{"rowPos":"{{$item.$index}}"}}}],"content":[{"name":"Mrs J. Jones","address":"32 Elm Grove, Glasgow, G32 5DR","phone":"07854 254 123"}],"model":"data__.api.bulkUplift.getJobs","autoscroll":false}],"expressions":{}},{"name":"staticContextMenu","type":"area","item-type":"static","content":[{"name":"jobListMenu","type":"component","item-type":"web-component-es2015","template":"<ct-context-menu></ct-context-menu>","content":[{"name":"btnChangePatch","type":"control","item-type":"button","content":"Change Neighbourhood","theme":"default","left-icon":"fa-map","actions":[{"name":"go_to_page_1","event":"click","type":"go-to-page","data":"PatchSelect"}],"expressions":{}},{"name":"btnLogout","type":"control","item-type":"button","content":"Log out","theme":"default","left-icon":"fa-sign-out","actions":[{"name":"inline_function_1","event":"click","type":"inline-function","data":{"code":"var currentJob = mdm.store.data__.currentJob;\n\nif(currentJob) {\n  var popup = document.getElementById('logoutErr');\n  popup.togglePopup();\n}\nelse {\n  // Will need to delete all user data here too\n  \n  var ids = [];\n  \n  for(var i = 0; i < mdm.store.data__.api.bulkUplift.getJobs.length; i++) {\n  \tids.push(mdm.store.data__.api.bulkUplift.getJobs[i].JobRef)\n  }\n  \n  mdm.utils.callAction('call-api', {\"name\":\"bulkUplift\",\"operation\":\"unlockJobs\",\"params\":{\"jobRefs\": ids}});\n\n  mdm.utils.callAction('go-to-page', 'Splash');\n}"}}],"expressions":{}},{"name":"btnVersion","type":"control","item-type":"button","content":"Version 0.0.1","theme":"default","left-icon":"fa-code-fork","expressions":{}}],"component":"CTContextMenu","attributes":{},"actions":[],"expressions":{}},{"name":"popSelectJob","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlSelectJob","type":"content","item-type":"html","content":"<p>Do you wish to start this job?</p>","expressions":{}},{"name":"btnYes","type":"control","item-type":"button","content":"Yes","theme":"default","expressions":{},"left-icon":"fa-check","classes":"green","actions":[{"name":"inline_function_1","event":"click","type":"inline-function","data":{"code":"var jobList = mdm.store.data__.api.bulkUplift.getJobs;\nvar rowPos = mdm.store.data__.selectedRow;\nvar selectedJob = jobList[rowPos];\n\nselectedJob.current = true;\nmdm.store.data__.currentJob = selectedJob;\n\njobList.splice(rowPos, 1);\nmdm.store.data__.api.bulkUplift.getJobs = jobList;\n\nvar remainingJobCount = jobList.length + 1;\nmdm.store.data__.remainingJobCount = remainingJobCount;\n\nvar popup = document.getElementById('selectJob');\npopup.togglePopup();\n\nmdm.utils.callAction('go-to-page', 'JobDetail');"}}]},{"name":"btnNo","type":"control","item-type":"button","content":"No","theme":"default","expressions":{},"left-icon":"fa-close","actions":[{"name":"call_function_1","event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"selectJob"}}}],"classes":"red"}],"component":"CTPopupBox","attributes":{"id":"selectJob"},"expressions":{}},{"name":"popMultiJobErr","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlMultiJobErr","type":"content","item-type":"html","content":"<p>You already have a current job set. Please complete the current job first.</p>","expressions":{}},{"name":"btnOk","type":"control","item-type":"button","content":"Okay","theme":"default","expressions":{},"left-icon":"fa-check","classes":"green","actions":[{"name":"call_function_1","event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"multiJobErr"}}}]}],"component":"CTPopupBox","attributes":{"id":"multiJobErr"},"expressions":{}},{"name":"popLogoutErr","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlLogoutErrMsg","type":"content","item-type":"html","content":"<p>You cannot log out whilst a job is active. Please complete the current job first.</p>","expressions":{}},{"name":"btnLogoutOk","type":"control","item-type":"button","content":"Okay","theme":"default","expressions":{},"classes":"green","actions":[{"name":"call_function_1","event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"logoutErr"}}}],"left-icon":"fa-check"}],"component":"CTPopupBox","attributes":{"id":"logoutErr"},"expressions":{}},{"name":"popAllComplete","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlAllComplete","type":"content","item-type":"html","content":"<p>You have completed all the jobs on the device. What would you like to do?</p>","expressions":{}},{"name":"btnMoreJobs","type":"control","item-type":"button","content":"Request More Jobs","theme":"default","left-icon":"fa-plus-circle","expressions":{},"classes":"green","actions":[{"name":"inline_function_1","event":"click","type":"inline-function","data":{"code":"var popup = document.getElementById('allComplete');\npopup.togglePopup();"}},{"name":"go_to_page_1","event":"click","type":"go-to-page","data":"RequestJobs"}]},{"name":"btnChangeNeigh","type":"control","item-type":"button","content":"Change Neighbourhood","theme":"default","left-icon":"fa-map","expressions":{},"classes":"green","actions":[{"name":"go_to_page_1","event":"click","type":"go-to-page","data":"PatchSelect"}]},{"name":"btnFinalLogout","type":"control","item-type":"button","content":"Logout","theme":"default","expressions":{},"classes":"red","actions":[{"name":"go_to_page_1","event":"click","type":"go-to-page","data":"Splash"}],"left-icon":"fa-sign-out"}],"component":"CTPopupBox","attributes":{"id":"allComplete"},"expressions":{}}],"expressions":{}}]},{"name":"JobDetail","config":[{"name":"On-Load Event","type":"event","item-type":"onload","actions":[{"name":"inline_function_1","event":"onload","type":"inline-function","data":{"code":"setTimeout(function() {\n  if(mdm.store.data__.currentJob.ArrivalTime === undefined) {\n    $('div#btnArrive').attr('classes', '');\n\t//$('div#btnFail').attr('classes', 'ng-hide');\n\t$('div#btnComplete').attr('classes', 'ng-hide');\n  }\n  else {\n    $('div#btnArrive').attr('classes', 'ng-hide');\n\t//$('div#btnFail').attr('classes', '');\n\t$('div#btnComplete').attr('classes', '');\n  }\n}, 50);"}}]}],"content":[{"name":"title_bar","type":"navigation","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnBack","type":"control","item-type":"button","content":"","theme":"default","expressions":{},"left-icon":"fa-arrow-left","actions":[{"name":"go_to_page_1","event":"click","type":"go-to-page","data":"JobList"}]},{"name":"btnMenu","type":"control","item-type":"button","content":"","theme":"default","expressions":{},"right-icon":"fa-bars","actions":[{"name":"call_function_1","event":"click","type":"call-function","data":{"name":"openContextMenu"}}]}]},{"name":"staticJobDetail","type":"area","item-type":"static","content":[{"name":"htmlJobDetail","type":"content","item-type":"html","content":"<h2>Current Job</h2>\n\n<div class=\"jobRow full\">\n  <div class=\"jobCell full address\">\n    <p class=\"name\">{{'data__.currentJob.CustomerName' | store}}</p>\n    <p>{{'data__.currentJob.SingleLineAddress' | store}}</p>\n    <p class=\"contact\">{{'data__.currentJob.Phone' | store}}<p>\n  </div>\n</div>","expressions":{}},{"name":"htmlJobArrived","type":"content","item-type":"html","content":"<div class=\"jobRow full\">\n  <div class=\"jobArrived\">\n    <span>Arrived at: <strong>{{'data__.currentJob.ArrivalTime' | store  | date : 'medium'}}</strong></span>\n  </div>\n</div>","expressions":{"show":"data__.currentJob.ArrivalTime"}}],"expressions":{}},{"name":"staticJobNotes","type":"area","item-type":"static","content":[{"name":"htmlJobNotes","type":"content","item-type":"html","content":"<h2>Notes</h2>\n\n<div class=\"jobNotes\">\n\t<p>{{'data__.currentJob.Notes' | store}}</p>\n</div>","expressions":{}}],"expressions":{}},{"name":"scrollInventory","type":"area","item-type":"scrollable","content":[{"name":"htmlInventory","type":"content","item-type":"html","content":"<h2>Inventory <span class=\"right\">Qty</span></h2>","expressions":{}},{"name":"list_2","type":"content","item-type":"list","title":"List","edit":false,"search":false,"row":"<div class=\"itemRow\">\n  <p>{{$item.ItemName}}</p> <span>{{$item.Qty}}</span>\n</div>","classes":"","actions":[],"content":[{"name":"Children's Chairs","qty":4},{"name":"Children's Table","qty":1}],"model":"data__.currentJob.Items"}],"expressions":{}},{"name":"staticContextMenu","type":"area","item-type":"static","content":[{"name":"jobDetailMenu","type":"component","item-type":"web-component-es2015","template":"<ct-context-menu></ct-context-menu>","content":[{"name":"btnPhoto","type":"control","item-type":"button","content":"Photos","theme":"default","expressions":{},"left-icon":"fa-camera","actions":[{"name":"go_to_page_1","event":"click","type":"go-to-page","data":"Photos"}]},{"name":"btnSignature","type":"control","item-type":"button","content":"Get Signature","theme":"default","expressions":{},"left-icon":"fa-edit","actions":[{"name":"go_to_page_1","event":"click","type":"go-to-page","data":"Signature"}]}],"component":"CTContextMenu","attributes":{},"expressions":{}}],"expressions":{}},{"name":"nav_footer","type":"navigation","item-type":"button-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnFail","type":"control","item-type":"button","content":"Fail Job","theme":"default","expressions":{},"classes":"","actions":[{"name":"go_to_page_1","event":"click","type":"go-to-page","data":"FailJob"}]},{"name":"btnArrive","type":"control","item-type":"button","content":"Arrived at Job","theme":"default","expressions":{},"actions":[{"name":"inline_function_1","event":"click","type":"inline-function","data":{"code":"mdm.store.data__.currentJob.ArrivalTime = moment().format();\n\n$('div#btnArrive').attr('classes', 'ng-hide');\n$('div#btnFail').attr('classes', '');\n$('div#btnComplete').attr('classes', '');"}}],"classes":""},{"name":"btnComplete","type":"control","item-type":"button","content":"Complete Job","theme":"default","expressions":{},"classes":"","actions":[{"name":"inline_function_1","event":"click","type":"inline-function","data":{"code":"var currentJob = mdm.store.data__.currentJob;\ncurrentJob.Completed = true;\ncurrentJob.Status = 'Success';\ncurrentJob.Reason = null;\ncurrentJob.FailDetail = null;\n\nmdm.utils.callAction('call-api', {\"name\":\"bulkUplift\",\"operation\":\"updateJob\",\"params\":{\"job\": currentJob}});\n\nmdm.store.data__.completedJobs.push(currentJob);\ndelete mdm.store.data__.currentJob;\n//mdm.store.data__.api.bulkUplift.getJobs.splice(mdm.store.data__.selectedRow, 1);\nmdm.store.data__.remainingJobCount = mdm.store.data__.api.bulkUplift.getJobs.length;\n\nmdm.utils.callAction('go-to-page', 'JobList');"}},{"name":"show_notification_1","event":"click","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"jobFinished","title":"Job Completed","text":"Job completed successfully. Now attempting to return job data."}}]}]}]},{"name":"Photos","config":[],"content":[{"name":"title_bar","type":"navigation","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnBack","type":"control","item-type":"button","content":"","theme":"default","left-icon":"fa-arrow-left","expressions":{},"actions":[{"name":"go_to_page_1","event":"click","type":"go-to-page","data":"JobDetail"}]}]},{"name":"scrollable","type":"area","item-type":"scrollable","content":[],"expressions":{}},{"name":"nav_footer","type":"navigation","item-type":"button-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnTakePhoto","type":"control","item-type":"button","content":"Take Photo","theme":"default","actions":[{"name":"inline_function_1","event":"click","type":"inline-function","data":{"code":"var currentJob = mdm.store.data__.currentJob;\n\nif(currentJob.EvidencePhotos === undefined) {\n  currentJob.EvidencePhotos = [];\n}\n\nif(currentJob.EvidencePhotos.length < 3) {\n  window.navigator.camera.getPicture(onCameraSuccess, onCameraError, {\n    quality: 75,\n    destinationType: Camera.DestinationType.FILE_URI,\n    sourceType: Camera.PictureSourceType.CAMERA,\n    allowEdit: false,\n    encodingType: Camera.EncodingType.JPEG,\n    saveToPhotoAlbum: true,\n    correctOrientation: true,\n    targetWidth: 640,\n    targetHeight: 480,\n    cameraDirection: Camera.Direction.BACK\n  }); \n}\nelse {\n  var popup = document.getElementById('photoList');\n  popup.togglePopup();\n}\n\nfunction onCameraSuccess(img) {\n  console.log('CAMERA RESULT: %s', img);\n  var currentJob = mdm.store.data__.currentJob;\n  currentJob.EvidencePhotos.push(img);\n}\n\nfunction onCameraError(r) {\n  console.log('CAMERA ERROR: %s', r);\n  var popup = document.getElementById('photoList');\n  popup.togglePopup();\n}"}}],"expressions":{}}]},{"name":"staticComponentCont","type":"area","item-type":"static","content":[{"name":"popPhotoError","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlMessage","type":"content","item-type":"html","content":"<p>You can only take a maximum of 3 photos per job.</p>","expressions":{}},{"name":"btnPhotoOkay","type":"control","item-type":"button","content":"Okay","theme":"default","expressions":{},"actions":[{"name":"call_function_1","event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"photoLimit"}}}],"classes":"green"}],"component":"CTPopupBox","attributes":{"id":"photoLimit"},"expressions":{},"actions":[]}],"expressions":{}}]},{"name":"Signature","config":[{"name":"On-Load Event","type":"event","item-type":"onload","actions":[{"name":"inline_function_1","event":"onload","type":"inline-function","data":{"code":"if(1 == 2) {\n  setTimeout(function() {\n    var canvas = document.getElementsByTagName('canvas')[0];\n    canvas.width = window.innerWidth;\n\n    if(mdm.store.Signature.sigJobSig !== undefined) {\n      var sig = new SignaturePad(document.getElementsByTagName('canvas')[0]);\n\n      sig.fromDataURL(mdm.store.Signature.sigJobSig);\n    }\n  }, 200);\n}"}}]}],"content":[{"name":"title_bar","type":"navigation","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnBack","type":"control","item-type":"button","content":"","theme":"default","left-icon":"fa-arrow-left","actions":[{"name":"go_to_page_1","event":"click","type":"go-to-page","data":"JobDetail"}],"expressions":{}}]},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"sigJobSig","type":"question","item-type":"signature","label":"","required":false,"expressions":{},"validators":[],"actions":[]}]},{"name":"nav_footer","type":"navigation","item-type":"button-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnConfirm","type":"control","item-type":"button","content":"Confirm","theme":"default","expressions":{},"actions":[{"name":"go_to_page_1","event":"click","type":"go-to-page","data":"JobDetail"}]}]}]},{"name":"PatchSelect","config":[],"content":[{"name":"title_bar","type":"navigation","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnBack","type":"control","item-type":"button","content":"","theme":"default","left-icon":"fa-arrow-left","actions":[{"name":"go_to_page_1","event":"click","type":"go-to-page","data":"Splash"}],"expressions":{}}]},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"drpPatchSelect","type":"question","item-type":"select","label":"Select Neighbourhood","required":true,"options":[{"label":"Option 1","value":1},{"label":"Option 2","value":2},{"label":"WEEE","value":3}],"expressions":{},"message":"This is a required field","option-source":"data__.api.bulkUplift.getNeighbourhoods","validators":[],"actions":[],"label-property":"label","value-property":"value"}]},{"name":"nav_footer","type":"navigation","item-type":"button-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnNext","type":"control","item-type":"button","content":"Request Jobs","theme":"default","expressions":{"disabled":"PatchSelect.drpPatchSelect.value === undefined"},"actions":[{"name":"inline_function_2","event":"click","type":"inline-function","data":{"code":"delete mdm.store.data__.jobList;\nmdm.store.data__.currentPatch = mdm.store.PatchSelect.drpPatchSelect.value;"}},{"name":"call_api_1","event":"click","type":"call-api","data":{"name":"bulkUplift","operation":"getJobs","params":{"Neighbourhood":"{{PatchSelect.drpPatchSelect.value}}"}},"actions":[{"name":"inline_function_1","event":"success","type":"inline-function","data":{"code":"delete mdm.store.PatchSelect.drpPatchSelect;\nmdm.utils.callAction('go-to-page', 'JobList')"}}]}]}]}]},{"name":"FailJob","config":[],"content":[{"name":"title_bar","type":"navigation","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnBack","type":"control","item-type":"button","content":"","theme":"default","expressions":{},"actions":[{"name":"go_back_1","event":"click","type":"go-back","data":{}}],"left-icon":"fa-arrow-left"}]},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"drpFail","type":"question","item-type":"select","label":"Select Reason for Fail:","required":true,"options":[{"label":"Not found e.g lifted by white van man/not ready for presentation","value":"Not found"},{"label":"Not in location provided","value":"Not in location provided"},{"label":"No access e.g parking/gate locked","value":"No access"},{"label":"Not presented correctly e.g tied/nails","value":"Not presented correctly"},{"label":"Too heavy e.g mattress out in rain/cast iron bath","value":"Too heavy"},{"label":"Contractor involved e.g chargeable items","value":"Contractor involved"},{"label":"Part uplift e.g in phases (house clearance)","value":"Part uplift"},{"label":"Other","value":"Other"}],"expressions":{},"searchable":false,"message":"This is a required field","validators":[],"actions":[]},{"name":"txtFailMore","type":"question","item-type":"text","label":"More Information:","required":false,"multiline":true,"debounce":250,"expressions":{},"validators":[],"actions":[]}]},{"name":"nav_footer","type":"navigation","item-type":"button-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnFailConfirm","type":"control","item-type":"button","content":"Confirm","theme":"default","expressions":{"show":"FailJob.drpFail.value"},"actions":[{"name":"inline_function_1","event":"click","type":"inline-function","data":{"code":"// Mark job as failed, etc\nvar currentJob = mdm.store.data__.currentJob;\ncurrentJob.complete = true;\ncurrentJob.status = 'Failed';\ncurrentJob.reason = mdm.store.FailJob.drpFail.label;\ncurrentJob.failInfo = mdm.store.FailJob.txtFailMore || null;\n\nmdm.store.data__.completedJobs.push(currentJob);\ndelete mdm.store.data__.currentJob;\n//mdm.store.data__.api.bulkUplift.getJobs.splice(mdm.store.data__.selectedRow, 1);\nmdm.store.data__.remainingJobCount = mdm.store.data__.api.bulkUplift.getJobs.length;\n\nmdm.utils.callAction('go-to-page', 'JobList');"}},{"name":"show_notification_1","event":"click","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"jobFinished","title":"Job Completed","text":"Job marked as failed due to: {{FailJob.drpFail.label}}. Now attempting to return job data."}}]}]}]},{"name":"DynaFormTest","config":[],"content":[{"name":"static_9","type":"area","item-type":"static","content":[{"name":"button_27","type":"control","item-type":"button","content":"Open Menu","theme":"default","actions":[{"name":"call_function_1","event":"click","type":"call-function","data":{"name":"openContextMenu"}}],"right-icon":"fa-caret-down"}]},{"name":"static_8","type":"area","item-type":"static","content":[{"name":"CTDynaForm_1","type":"component","item-type":"web-component-es2015","template":"<ct-dyna-form></ct-dyna-form>","content":[{"name":"text_2","type":"question","item-type":"text","label":"Text: ","required":false,"multiline":false,"debounce":250},{"name":"smiley_1","type":"question","item-type":"smiley","extends":{"type":"question","item-type":"radio"},"label":"Smiley: ","required":false,"options":[{"label":"","value":1,"icon-selected":"fa-smile-o","icon-unselected":"fa-smile-o"},{"label":"","value":2,"icon-selected":"fa-meh-o","icon-unselected":"fa-meh-o"},{"label":"","value":3,"icon-selected":"fa-frown-o","icon-unselected":"fa-frown-o"}]},{"name":"rating_1","type":"question","item-type":"rating","label":"Rating: ","required":false,"max":5}],"component":"CTDynaForm","attributes":{}}],"expressions":{}},{"name":"static_10","type":"area","item-type":"static","content":[{"name":"CTContextMenu_1","type":"component","item-type":"web-component-es2015","template":"<ct-context-menu></ct-context-menu>","content":[{"name":"button_28","type":"control","item-type":"button","content":"Sample Button"},{"name":"button_29","type":"control","item-type":"button","content":"Sample Button"}],"component":"CTContextMenu","attributes":{"Popup":true,"MinWidth":null,"Orientation":"left"}}],"expressions":{}}]},{"name":"RequestJobs","config":[],"content":[{"name":"title_bar","type":"navigation","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnBack","type":"control","item-type":"button","content":"","theme":"default","left-icon":"fa-arrow-left","expressions":{},"actions":[{"name":"go_back_1","event":"click","type":"go-back","data":{}}]}]},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"sliNoOfJobs","type":"question","item-type":"slider","label":"Number of Jobs:","required":false,"dual":false,"min":5,"max":15,"step":5,"message":"This is a required field","validators":[],"actions":[],"expressions":{}}]},{"name":"nav_footer","type":"navigation","item-type":"button-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnRequestJobs","type":"control","item-type":"button","content":"Request Jobs","theme":"default","expressions":{},"actions":[{"name":"if_1","type":"if","data":{},"operations":[{"type":"value","content":"{{data__.api.bulkUplift.getJobs.length}}"},{"type":"operator","content":">"},{"type":"value","content":"0"}]},{"name":"inline_function_1","event":"click","type":"inline-function","data":{"code":"var popup = document.getElementById('jobsError');\npopup.togglePopup();"}},{"name":"otherwise_1","type":"otherwise","data":{}},{"name":"call_api_1","event":"click","type":"call-api","data":{"name":"bulkUplift","operation":"getJobs","params":{"Neighbourhood":"data__.currentPatch"}},"actions":[]}]}]},{"name":"staticCompContainer","type":"area","item-type":"static","content":[{"name":"popJobsError","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlJobsError","type":"content","item-type":"html","content":"<p>You already have jobs on the device. Please complete these before requesting more.</p>","expressions":{}},{"name":"btnOkayJobsError","type":"control","item-type":"button","content":"Okay","theme":"default","expressions":{},"actions":[{"name":"call_function_1","event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"jobsError"}}}],"classes":"green","left-icon":"fa-check"}],"component":"CTPopupBox","attributes":{"id":"jobsError"},"expressions":{}}],"expressions":{}}]}],"config":[{"name":"theme_1","type":"style","item-type":"theme","content":"body{background-color:#f3f3f3}h1,h2,h3,h4,h5,h6,p{font-family:Helvetica !important;color:#555}h2{font-size:16px;font-weight:bold;margin-top:20px;margin-left:3vw;clear:both}h2 span.right{float:right;margin-right:3vw}.btn-default:hover{background-color:initial;border-color:initial;color:white}section[item-type=\"static\"],section[item-type=\"scrollable\"]{border:none !important;background-color:#f3f3f3;-webkit-box-shadow:none;box-shadow:none;padding:0 !important}section[item-type=\"scrollable\"]{overflow-y:auto}section[item-type=\"static\"] ul,section[item-type=\"scrollable\"] ul{list-style:none !important;margin:0 !important;padding:0 !important}.md-list ul li{position:initial !important}.md-list .scrollable{overflow-y:auto !important;margin:0 !important}.app-container,.page-container{background-color:#f3f3f3}.content-block{margin-bottom:0 !important}#staticSplash{background-color:#ec5343;height:80vh}#staticSplash img{margin:3vh 10vw 3vh;width:8vw;min-width:160px;min-height:261px}#staticSplash h2{color:white;line-height:58px;font-size:48px;font-weight:bold;margin-left:10vw;margin-bottom:5vh}#staticSplash a#btnStart,#staticSplash a#btnStart:hover{border:1px solid white !important;color:white !important;border-radius:5px;background-color:#ec5343 !important;width:40vw;padding:2vh 0}#staticDescription{height:20vh}#staticDescription p{text-align:center;margin:5vw}#titleJobsList,#title_bar,#nav_footer{background-color:#ec5343;color:white;justify-content:flex-end}#titleJobsList a#btnMenu,#title_bar a#btnMenu,#title_bar a#btnBack,#nav_footer div a,#title_bar a.btn-default:hover{background-color:#ec5343 !important;color:white !important;border:none !important}#title_bar div#btnBack{margin-right:auto}#nav_footer{justify-content:center}#nav_footer div{flex-basis:50%}#nav_footer div[classes=\"ng-hide\"]{display:none}#nav_footer div a{font-size:20px}.contextMenuBG{position:absolute;width:100vw;height:100vh;top:0;left:0;background-color:rgba(0,0,0,0.3);z-index:999}ct-context-menu .contextMenuBG .contextMenu{position:absolute;width:60vw;height:100vh;top:0;right:-60vw;background-color:rgba(0,0,0,0.6);z-index:1000;-webkit-animation:slide .5s forwards}@-webkit-keyframes slide{100%{right:0}}@keyframes slide{100%{right:0}}ct-context-menu .contextMenuBG .contextMenu div{margin:0;border-bottom:1px solid white}ct-context-menu .contextMenuBG .contextMenu div a,ct-context-menu .contextMenuBG .contextMenu div a:hover{color:white !important;border:none;background-color:transparent !important;width:100%;padding:3vh 0;text-align:left;margin-left:3vw}ct-context-menu .contextMenuBG .contextMenu div a span span:before{margin-right:3vw;width:8vw;display:inline-block;text-align:center}ct-context-menu[popup=\"true\"] .contextMenuBG{background-color:transparent}ct-context-menu[popup=\"true\"] .contextMenu{position:absolute;z-index:1000;background-color:white;border:1px solid #d3d3d3;height:initial;-webkit-animation:none}ct-context-menu[popup=\"true\"] .contextMenuBG .contextMenu div{border-top:1px solid #d3d3d3}ct-context-menu[popup=\"true\"] .contextMenuBG .contextMenu div:first-child{border-top:none}ct-context-menu[popup=\"true\"] .contextMenuBG .contextMenu div a,ct-context-menu[popup=\"true\"] .contextMenuBG .contextMenu div a:hover{color:black !important;margin-left:0;text-align:center;padding:2vh 0}ct-popup-box div.popupBG{display:flex;position:absolute;top:0;left:0;width:100vw;height:100vh;background-color:rgba(0,0,0,0.6);z-index:999}ct-popup-box div.popupBG div.popupBox{width:80vw;background-color:white;margin:auto;display:flex;flex-wrap:wrap;justify-content:center}ct-popup-box md-content{margin:2vh auto;text-align:center;padding:3vh 4vw 0}ct-popup-box .md-button-container{margin:0 auto !important;width:72vw}ct-popup-box .md-button-container a,ct-popup-box .md-button-container a:hover{color:white !important;width:100%;border:none;padding:2vh 0;margin-bottom:2vh}ct-popup-box div[classes=\"green\"] a,ct-popup-box div[classes=\"green\"] a:hover{background-color:green !important}ct-popup-box div[classes=\"red\"] a,ct-popup-box div[classes=\"red\"] a:hover{background-color:red !important}.box{width:35vw;height:15vh;display:flex;flex-direction:column;border:1px solid #d3d3d3;float:left;background-color:white;text-align:center}.box:nth-child(3),.box:nth-child(4){border-left:none}.box h3{word-wrap:break-word;white-space:pre-line;margin:auto 2vw;font-size:18px}.box h3 span{font-size:62px}.box.btn{width:30vw;background-color:#ec5343}.box.btn h3{color:white;line-height:28px}.jobRow{clear:both;margin:0}.jobRow.full{margin:0 !important}.jobRow .jobCell{float:left;border-left:1px solid #d3d3d3;border-right:1px solid #d3d3d3;border-bottom:1px solid #d3d3d3;height:12vh;display:flex;flex-direction:column}ul li:first-child span div.jobRow .jobCell{border-top:1px solid #d3d3d3}.jobRow.borderTop .jobCell{margin-bottom:20px;border-top:1px solid #d3d3d3}.jobRow .jobCell p{margin:auto 3vw;padding:0}.jobRow .jobCell.location{width:15vw;background-color:#d3d3d3;border-bottom:1px solid white;flex-direction:row}.jobRow .jobCell.location p,.jobRow .jobCell.btn p{margin:auto}.jobRow .jobCell.location p:before{font-family:FontAwesome;content:\"\\f041\";font-size:28px}.jobRow .jobCell.address{width:70vw;background-color:white}.jobRow .jobCell.address p.name{font-weight:bold}.jobRow .jobCell.address p.contact,.jobRow .jobCell.address p.contact a{font-weight:bold;color:#ec5343}.jobRow .jobCell.btn{width:15vw;background-color:#ec5343;color:white}.jobRow .jobCell.btn p:before{font-family:FontAwesome;content:\"\\f054\";color:white;font-size:28px}.jobRow .jobCell.full{width:100vw !important;border-top:1px solid #d3d3d3}.jobRow .jobCell:nth-child(3),.jobRow .jobCell:nth-child(4){border-left:none}.jobRow .jobArrived{background-color:#dff0d8;text-align:center;padding:2vh 0;color:#3c763d;border-bottom:1px solid #d6e9c6}div.jobNotes{padding:2vh 0;background-color:white;border:1px solid #d3d3d3;display:flex}div.jobNotes p{margin:auto 3vw}.itemRow{background-color:white;padding:1vh 3vw;display:flex;justify-content:flex-start;border-bottom:1px solid #d3d3d3}ul li:first-child span div.itemRow{border-top:1px solid #d3d3d3}.itemRow p{margin:0}.itemRow span{margin-left:auto}md-question div{margin:3vh 3vw 0}textarea.form-control{height:35vh}.btn-default:hover{background-color:white !important;border-color:#ccc !important;color:#333 !important}"},{"name":"bulkUplift","type":"integration","item-type":"api","headers":{},"params":[],"operations":[{"name":"authTest","summary":"Authorisation test","path":"authtest","method":"POST","content-type":"application/json"},{"name":"getNeighbourhoods","summary":"Gets neighbourhood dropdown values","path":"getNeighbourhoodDropdown","method":"GET","content-type":"application/json"},{"name":"getJobs","summary":"Gets jobs for selected neighbourhood","path":"getJobs","method":"GET","content-type":"application/json","params":[{"name":"Neighbourhood","description":"Neighbourhood of jobs","type":"string","typeConfig":{},"in":"query","required":true}]},{"name":"unlockJobs","summary":"Unlocks remaining jobs","path":"unlockJobs","method":"POST","content-type":"application/json","params":[{"name":"jobRefs","description":"jobRefs","type":"string","typeConfig":{},"in":"body","required":true}]},{"name":"updateJob","summary":"Updates a job","path":"updateJob","method":"POST","content-type":"application/json","params":[{"name":"job","description":"Job Object","type":"string","typeConfig":{},"in":"body","required":true}]}],"url":"http://ct-gcc-bulk-uplift-dev.azurewebsites.net/api/"},{"name":"openContextMenu","type":"script","item-type":"function","params":[],"content":"var contextMenu = document.getElementsByTagName('ct-context-menu')[0]\ncontextMenu.toggleMenu();","sync":true},{"name":"setCurrentJob","type":"script","item-type":"function","params":[{"name":"rowPos","required":true}],"content":"var currentJob = mdm.store.data__.currentJob;\n\nif(currentJob) {\n  var popup = document.getElementById('multiJobErr');\n  popup.togglePopup();\n}\nelse {  \n  mdm.store.data__.selectedRow = rowPos;\n  \n  var popup = document.getElementById('selectJob');\n  popup.togglePopup();\n}"},{"name":"cancelPopup","type":"script","item-type":"function","params":[{"name":"popupId","required":true}],"content":"var popup = document.getElementById(popupId);\npopup.togglePopup();"},{"name":"jobFinished","type":"notification","item-type":"app-notification","options":{"autoDismiss":true,"closeButton":true},"style":"success","actions":[]},{"name":"js_asset_1","type":"script","item-type":"js-asset","fileName":"Moment.js"}],"components":[{"content":"InVzZSBzdHJpY3QiOwoKdmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTsKCnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KF94LCBfeDIsIF94MykgeyB2YXIgX2FnYWluID0gdHJ1ZTsgX2Z1bmN0aW9uOiB3aGlsZSAoX2FnYWluKSB7IHZhciBvYmplY3QgPSBfeCwgcHJvcGVydHkgPSBfeDIsIHJlY2VpdmVyID0gX3gzOyBkZXNjID0gcGFyZW50ID0gZ2V0dGVyID0gdW5kZWZpbmVkOyBfYWdhaW4gPSBmYWxzZTsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IF94ID0gcGFyZW50OyBfeDIgPSBwcm9wZXJ0eTsgX3gzID0gcmVjZWl2ZXI7IF9hZ2FpbiA9IHRydWU7IGNvbnRpbnVlIF9mdW5jdGlvbjsgfSB9IGVsc2UgaWYgKCJ2YWx1ZSIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH0gfTsKCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBDVENvbnRleHRNZW51ID0gKGZ1bmN0aW9uIChfSFRNTEVsZW1lbnQpIHsKICAgIF9pbmhlcml0cyhDVENvbnRleHRNZW51LCBfSFRNTEVsZW1lbnQpOwoKICAgIGZ1bmN0aW9uIENUQ29udGV4dE1lbnUoKSB7CiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIF9DVENvbnRleHRNZW51KTsKCiAgICAgICAgX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoX0NUQ29udGV4dE1lbnUucHJvdG90eXBlKSwgImNvbnN0cnVjdG9yIiwgdGhpcykuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICBfY3JlYXRlQ2xhc3MoQ1RDb250ZXh0TWVudSwgW3sKICAgICAgICBrZXk6ICJhdHRhY2hlZENhbGxiYWNrIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXR0YWNoZWRDYWxsYmFjaygpIHsKICAgICAgICAgICAgdGhpcy5wb3B1cCA9IHRoaXMuZ2V0QXR0cmlidXRlKCdwb3B1cCcpOwogICAgICAgICAgICB0aGlzLm1pbldpZHRoID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ21pbndpZHRoJykgPT09ICdudWxsJyA/IDAgOiBwYXJzZUludCh0aGlzLmdldEF0dHJpYnV0ZSgnbWlud2lkdGgnKSk7CiAgICAgICAgICAgIHRoaXMub3JpZW50YXRpb24gPSB0aGlzLmdldEF0dHJpYnV0ZSgnb3JpZW50YXRpb24nKTsKCiAgICAgICAgICAgIHZhciBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgY29udGFpbmVyLmNsYXNzTmFtZSA9ICdjb250ZXh0TWVudUJHJzsKICAgICAgICAgICAgY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CgogICAgICAgICAgICB2YXIgbWVudSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICBtZW51LmNsYXNzTmFtZSA9ICdjb250ZXh0TWVudSc7CgogICAgICAgICAgICB3aGlsZSAodGhpcy5jaGlsZE5vZGVzLmxlbmd0aCAhPT0gMCkgewogICAgICAgICAgICAgICAgbWVudS5hcHBlbmRDaGlsZCh0aGlzLmNoaWxkTm9kZXNbMF0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy53aW5kb3dTaXplQ2hhbmdlKTsKCiAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChtZW51KTsKICAgICAgICAgICAgdGhpcy5hcHBlbmRDaGlsZChjb250YWluZXIpOwogICAgICAgICAgICB0aGlzLm9wZW5lZCA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgLy8gVG9nZ2xlcyB0aGUgbWVudSBvcGVuZWQgYW5kIGNsb3NlZCBiYXNlZCBvbiB0aGUgdmFsdWUKICAgICAgICAvLyBvZiB0aGUgdGhpcy5vcGVuZWQgcHJvcGVydHkgKGluaXRpYWxseSBzZXQgdG8gZmFsc2UpCiAgICB9LCB7CiAgICAgICAga2V5OiAidG9nZ2xlTWVudSIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRvZ2dsZU1lbnUoKSB7CiAgICAgICAgICAgIHZhciBjb250ZXh0TWVudSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NvbnRleHRNZW51QkcnKVswXTsKCiAgICAgICAgICAgIGlmICghdGhpcy5vcGVuZWQpIHsKICAgICAgICAgICAgICAgIC8vIFBPUFVQIExPR0lDCiAgICAgICAgICAgICAgICBpZiAodGhpcy5wb3B1cCA9PT0gInRydWUiKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRDb250ZXh0TWVudUlubmVyKHRoaXMpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMub3BlbmVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGNvbnRleHRNZW51LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbG9zZU1lbnUsIHRydWUpOwogICAgICAgICAgICAgICAgY29udGV4dE1lbnUuc3R5bGUuZGlzcGxheSA9ICdpbml0aWFsJzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMub3BlbmVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBjb250ZXh0TWVudS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xvc2VNZW51KTsKICAgICAgICAgICAgICAgIGNvbnRleHRNZW51LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIFRoZSBjbG9zZSBmdW5jdGlvbiB3ZSBiaW5kIG91ciBjbGljayBldmVudCB0by4gVGhpcwogICAgICAgIC8vIGhhbmRsZXMga2VlcGluZyB0aGUgJ3RoaXMnIGtleXdvcmQgaW4gc2NvcGUKICAgIH0sIHsKICAgICAgICBrZXk6ICJjbG9zZU1lbnUiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9zZU1lbnUoZSkgewogICAgICAgICAgICB2YXIgY29udGV4dE1lbnUgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnY3QtY29udGV4dC1tZW51JylbMF07CiAgICAgICAgICAgIGNvbnRleHRNZW51LnRvZ2dsZU1lbnUoKTsKICAgICAgICB9CiAgICB9LCB7CiAgICAgICAga2V5OiAic2V0Q29udGV4dE1lbnVJbm5lciIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldENvbnRleHRNZW51SW5uZXIoY29udGV4dE1lbnUpIHsKICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzICE9PSBDVENvbnRleHRNZW51KSB7CiAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSBjb250ZXh0TWVudTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIGNvbnRleHRNZW51SW5uZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjb250ZXh0TWVudScpWzBdOwogICAgICAgICAgICB2YXIgcG9zID0gX3RoaXMuZ2VuZXJhdGVQb3NpdGlvbk9uUGFnZSgpOwogICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdQT1BVUCBQb3NpdGlvbnM6ICcsIHBvcy50b1N0cmluZygpKTsKICAgICAgICAgICAgY29udGV4dE1lbnVJbm5lci5zdHlsZS50b3AgPSBwb3MudG9wICsgJ3B4JzsKCiAgICAgICAgICAgIGlmIChfdGhpcy5vcmllbnRhdGlvbiA9PSAncmlnaHQnICYmIF90aGlzLm1pbldpZHRoICE9PSAwKSB7CiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gcG9zLmxlZnQgLSAoX3RoaXMubWluV2lkdGggLSBwb3Mud2lkdGgpOwogICAgICAgICAgICAgICAgY29udGV4dE1lbnVJbm5lci5zdHlsZS5sZWZ0ID0gb2Zmc2V0ICsgJ3B4JzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbnRleHRNZW51SW5uZXIuc3R5bGUubGVmdCA9IHBvcy5sZWZ0ICsgJ3B4JzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKF90aGlzLm1pbldpZHRoICE9PSAwICYmIHBvcy53aWR0aCA8IF90aGlzLm1pbldpZHRoKSB7CiAgICAgICAgICAgICAgICBjb250ZXh0TWVudUlubmVyLnN0eWxlLndpZHRoID0gX3RoaXMubWluV2lkdGggKyAncHgnOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY29udGV4dE1lbnVJbm5lci5zdHlsZS53aWR0aCA9IHBvcy53aWR0aCArICdweCc7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9LCB7CiAgICAgICAga2V5OiAiZ2VuZXJhdGVQb3NpdGlvbk9uUGFnZSIsCiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdlbmVyYXRlUG9zaXRpb25PblBhZ2UoKSB7CiAgICAgICAgICAgIC8vIFRFTVAKICAgICAgICAgICAgdmFyIGNhbGxpbmdCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdhI2J1dHRvbl8yNycpOwoKICAgICAgICAgICAgdmFyIGNhbGxpbmdCdG5Qb3MgPSBjYWxsaW5nQnRuLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgICAgICB2YXIgcGFkVG9wID0gJChjYWxsaW5nQnRuKS5jc3MoJ3BhZGRpbmctdG9wJyk7CiAgICAgICAgICAgIHZhciBwYWRCb3QgPSAkKGNhbGxpbmdCdG4pLmNzcygncGFkZGluZy1ib3R0b20nKTsKICAgICAgICAgICAgdmFyIGJvcmRlcldpZHRoID0gJChjYWxsaW5nQnRuKS5jc3MoJ2JvcmRlci13aWR0aCcpOwoKICAgICAgICAgICAgdmFyIHBhZFRvcCA9IHBhcnNlSW50KHBhZFRvcC5zdWJzdHJpbmcoMCwgcGFkVG9wLmxlbmd0aCAtIDIpKTsKICAgICAgICAgICAgdmFyIHBhZEJvdCA9IHBhcnNlSW50KHBhZEJvdC5zdWJzdHJpbmcoMCwgcGFkQm90Lmxlbmd0aCAtIDIpKTsKICAgICAgICAgICAgdmFyIGJvcmRlcldpZHRoID0gcGFyc2VJbnQoYm9yZGVyV2lkdGguc3Vic3RyaW5nKDAsIGJvcmRlcldpZHRoLmxlbmd0aCAtIDIpKTsKCiAgICAgICAgICAgIHZhciB0b3AgPSBjYWxsaW5nQnRuUG9zLnRvcCArIHBhZFRvcCArIHBhZEJvdCArIGJvcmRlcldpZHRoOwogICAgICAgICAgICB2YXIgbGVmdCA9IGNhbGxpbmdCdG5Qb3MubGVmdDsKICAgICAgICAgICAgdmFyIHJpZ2h0ID0gY2FsbGluZ0J0blBvcy5yaWdodDsKICAgICAgICAgICAgdmFyIHdpZHRoID0gY2FsbGluZ0J0blBvcy53aWR0aDsKCiAgICAgICAgICAgIHZhciByZXMgPSB7CiAgICAgICAgICAgICAgICB0b3A6IHRvcCwKICAgICAgICAgICAgICAgIGxlZnQ6IGxlZnQsCiAgICAgICAgICAgICAgICByaWdodDogcmlnaHQsCiAgICAgICAgICAgICAgICB3aWR0aDogd2lkdGgKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgfQogICAgfSwgewogICAgICAgIGtleTogIndpbmRvd1NpemVDaGFuZ2UiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB3aW5kb3dTaXplQ2hhbmdlKCkgewogICAgICAgICAgICB2YXIgY29udGV4dE1lbnUgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnY3QtY29udGV4dC1tZW51JylbMF07CgogICAgICAgICAgICBpZiAoY29udGV4dE1lbnUub3BlbmVkKSB7CiAgICAgICAgICAgICAgICBpZiAoY29udGV4dE1lbnUucG9wdXAgPT09ICJ0cnVlIikgewogICAgICAgICAgICAgICAgICAgIGNvbnRleHRNZW51LnNldENvbnRleHRNZW51SW5uZXIoY29udGV4dE1lbnUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfV0pOwoKICAgIHZhciBfQ1RDb250ZXh0TWVudSA9IENUQ29udGV4dE1lbnU7CiAgICBDVENvbnRleHRNZW51ID0gV2ViQ29tcG9uZW50cy5hbm5vdGF0ZSh7CiAgICAgICAgImF0dHJpYnV0ZXMiOiB7CiAgICAgICAgICAgICJwcm9wZXJ0aWVzIjogewogICAgICAgICAgICAgICAgIlBvcHVwIjogewogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogImJvb2xlYW4iCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgIk1pbldpZHRoIjogewogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogImludGVnZXIiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgIk9yaWVudGF0aW9uIjogewogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInN0cmluZyIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgInJlcXVpcmVkIjogWyJQb3B1cCJdCiAgICAgICAgfSwKICAgICAgICAiY29udGFpbmVyIjogdHJ1ZQogICAgfSkoQ1RDb250ZXh0TWVudSkgfHwgQ1RDb250ZXh0TWVudTsKICAgIHJldHVybiBDVENvbnRleHRNZW51Owp9KShIVE1MRWxlbWVudCk7Cgpkb2N1bWVudC5yZWdpc3RlckVsZW1lbnQoJ2N0LWNvbnRleHQtbWVudScsIENUQ29udGV4dE1lbnUpOw==","type":"web-component-es2015","element":"ct-context-menu","usage":"<ct-context-menu></ct-context-menu>","name":"CTContextMenu"},{"content":"InVzZSBzdHJpY3QiOwoKdmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTsKCnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KF94LCBfeDIsIF94MykgeyB2YXIgX2FnYWluID0gdHJ1ZTsgX2Z1bmN0aW9uOiB3aGlsZSAoX2FnYWluKSB7IHZhciBvYmplY3QgPSBfeCwgcHJvcGVydHkgPSBfeDIsIHJlY2VpdmVyID0gX3gzOyBkZXNjID0gcGFyZW50ID0gZ2V0dGVyID0gdW5kZWZpbmVkOyBfYWdhaW4gPSBmYWxzZTsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IF94ID0gcGFyZW50OyBfeDIgPSBwcm9wZXJ0eTsgX3gzID0gcmVjZWl2ZXI7IF9hZ2FpbiA9IHRydWU7IGNvbnRpbnVlIF9mdW5jdGlvbjsgfSB9IGVsc2UgaWYgKCJ2YWx1ZSIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH0gfTsKCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBDVFBvcHVwQm94ID0gKGZ1bmN0aW9uIChfSFRNTEVsZW1lbnQpIHsKCV9pbmhlcml0cyhDVFBvcHVwQm94LCBfSFRNTEVsZW1lbnQpOwoKCWZ1bmN0aW9uIENUUG9wdXBCb3goKSB7CgkJX2NsYXNzQ2FsbENoZWNrKHRoaXMsIF9DVFBvcHVwQm94KTsKCgkJX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoX0NUUG9wdXBCb3gucHJvdG90eXBlKSwgImNvbnN0cnVjdG9yIiwgdGhpcykuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKCX0KCglfY3JlYXRlQ2xhc3MoQ1RQb3B1cEJveCwgW3sKCQlrZXk6ICJhdHRhY2hlZENhbGxiYWNrIiwKCQl2YWx1ZTogZnVuY3Rpb24gYXR0YWNoZWRDYWxsYmFjaygpIHsKCQkJdmFyIGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwoJCQljb250YWluZXIuY2xhc3NOYW1lID0gJ3BvcHVwQkcnOwoJCQljb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKCgkJCXZhciBwb3B1cEJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwoJCQlwb3B1cEJveC5jbGFzc05hbWUgPSAncG9wdXBCb3gnOwoKCQkJd2hpbGUgKHRoaXMuY2hpbGROb2Rlcy5sZW5ndGggIT09IDApIHsKCQkJCXBvcHVwQm94LmFwcGVuZENoaWxkKHRoaXMuY2hpbGROb2Rlc1swXSk7CgkJCX0KCgkJCWNvbnRhaW5lci5hcHBlbmRDaGlsZChwb3B1cEJveCk7CgkJCXRoaXMuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTsKCQkJdGhpcy5vcGVuZWQgPSBmYWxzZTsKCQkJdGhpcy5pZCA9IHRoaXMuZ2V0QXR0cmlidXRlKCJpZCIpOwoJCX0KCgkJLy8gVG9nZ2xlcyB0aGUgbWVudSBvcGVuZWQgYW5kIGNsb3NlZCBiYXNlZCBvbiB0aGUgdmFsdWUKCQkvLyBvZiB0aGUgdGhpcy5vcGVuZWQgcHJvcGVydHkgKGluaXRpYWxseSBzZXQgdG8gZmFsc2UpCgl9LCB7CgkJa2V5OiAidG9nZ2xlUG9wdXAiLAoJCXZhbHVlOiBmdW5jdGlvbiB0b2dnbGVQb3B1cCgpIHsKCQkJdmFyIGNvbnRleHRNZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignY3QtcG9wdXAtYm94IycgKyB0aGlzLmlkICsgJyA+IC5wb3B1cEJHJyk7CgoJCQlpZiAoIXRoaXMub3BlbmVkKSB7CgkJCQl0aGlzLm9wZW5lZCA9IHRydWU7CgkJCQkvL2NvbnRleHRNZW51LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbG9zZU1lbnUsIHRydWUpOwoJCQkJY29udGV4dE1lbnUuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKCQkJfSBlbHNlIHsKCQkJCXRoaXMub3BlbmVkID0gZmFsc2U7CgkJCQkvL2NvbnRleHRNZW51LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbG9zZU1lbnUpOwoJCQkJY29udGV4dE1lbnUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKCQkJfQoJCX0KCX1dKTsKCgl2YXIgX0NUUG9wdXBCb3ggPSBDVFBvcHVwQm94OwoJQ1RQb3B1cEJveCA9IFdlYkNvbXBvbmVudHMuYW5ub3RhdGUoewoJCSJhdHRyaWJ1dGVzIjogewoJCQkicHJvcGVydGllcyI6IHsKCQkJCSJpZCI6IHsKCQkJCQkidHlwZSI6ICJzdHJpbmciCgkJCQl9CgkJCX0sCgkJCSJyZXF1aXJlZCI6IFsiaWQiXQoJCX0sCgkJImNvbnRhaW5lciI6IHRydWUKCX0pKENUUG9wdXBCb3gpIHx8IENUUG9wdXBCb3g7CglyZXR1cm4gQ1RQb3B1cEJveDsKfSkoSFRNTEVsZW1lbnQpOwoKZG9jdW1lbnQucmVnaXN0ZXJFbGVtZW50KCdjdC1wb3B1cC1ib3gnLCBDVFBvcHVwQm94KTs=","type":"web-component-es2015","element":"ct-popup-box","usage":"<ct-popup-box></ct-popup-box>","name":"CTPopupBox"},{"content":"InVzZSBzdHJpY3QiOwoKdmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTsKCnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KF94LCBfeDIsIF94MykgeyB2YXIgX2FnYWluID0gdHJ1ZTsgX2Z1bmN0aW9uOiB3aGlsZSAoX2FnYWluKSB7IHZhciBvYmplY3QgPSBfeCwgcHJvcGVydHkgPSBfeDIsIHJlY2VpdmVyID0gX3gzOyBkZXNjID0gcGFyZW50ID0gZ2V0dGVyID0gdW5kZWZpbmVkOyBfYWdhaW4gPSBmYWxzZTsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IF94ID0gcGFyZW50OyBfeDIgPSBwcm9wZXJ0eTsgX3gzID0gcmVjZWl2ZXI7IF9hZ2FpbiA9IHRydWU7IGNvbnRpbnVlIF9mdW5jdGlvbjsgfSB9IGVsc2UgaWYgKCJ2YWx1ZSIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH0gfTsKCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBDVER5bmFGb3JtID0gKGZ1bmN0aW9uIChfSFRNTEVsZW1lbnQpIHsKICAgIF9pbmhlcml0cyhDVER5bmFGb3JtLCBfSFRNTEVsZW1lbnQpOwoKICAgIGZ1bmN0aW9uIENURHluYUZvcm0oKSB7CiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIF9DVER5bmFGb3JtKTsKCiAgICAgICAgX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoX0NURHluYUZvcm0ucHJvdG90eXBlKSwgImNvbnN0cnVjdG9yIiwgdGhpcykuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICBfY3JlYXRlQ2xhc3MoQ1REeW5hRm9ybSwgW3sKICAgICAgICBrZXk6ICJhdHRhY2hlZENhbGxiYWNrIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXR0YWNoZWRDYWxsYmFjaygpIHsKICAgICAgICAgICAgLy92YXIgZm9ybVNjaGVtYSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0odGhpcy5nZXRBdHRyaWJ1dGUoImlkIikpKTsKCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5jaGlsZE5vZGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkTm9kZXNbaV0uc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIGZvcm1TY2hlbWEgPSBbeyAiaXRlbS10eXBlIjogInRleHQiIH0sIHsgIml0ZW0tdHlwZSI6ICJ0ZXh0IiB9LCB7ICJpdGVtLXR5cGUiOiAidGV4dCIgfV07CgogICAgICAgICAgICB2YXIgZm9ybU5vZGVzID0gW107CgogICAgICAgICAgICBpZiAoZm9ybVNjaGVtYSkgewogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmb3JtU2NoZW1hLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGVsID0gZm9ybVNjaGVtYVtpXTsKCiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZmF1bHROb2RlTGVuZ3RoID0gdGhpcy5jaGlsZE5vZGVzLmxlbmd0aDsKCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCBkZWZhdWx0Tm9kZUxlbmd0aDsgYysrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNoaWxkTm9kZXNbY10uZ2V0QXR0cmlidXRlKCdpdGVtLXR5cGUnKSA9PSBlbFsnaXRlbS10eXBlJ10pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub2RlID0gdGhpcy5jaGlsZE5vZGVzW2NdLmNsb25lTm9kZSh0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc3R5bGUuZGlzcGxheSA9ICdpbml0aWFsJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1Ob2Rlcy5wdXNoKG5vZGUpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZm9ybU5vZGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBlbmRDaGlsZChmb3JtTm9kZXNbaV0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyB3aGlsZSh0aGlzLmNoaWxkTm9kZXMubGVuZ3RoICE9PSAwKSB7CiAgICAgICAgICAgIC8vICAgICBwb3B1cEJveC5hcHBlbmRDaGlsZCh0aGlzLmNoaWxkTm9kZXNbMF0pOwogICAgICAgICAgICAvLyB9CiAgICAgICAgfQogICAgfV0pOwoKICAgIHZhciBfQ1REeW5hRm9ybSA9IENURHluYUZvcm07CiAgICBDVER5bmFGb3JtID0gV2ViQ29tcG9uZW50cy5hbm5vdGF0ZSh7CiAgICAgICAgImF0dHJpYnV0ZXMiOiB7CiAgICAgICAgICAgICJwcm9wZXJ0aWVzIjogewogICAgICAgICAgICAgICAgImlkIjogewogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInN0cmluZyIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgInJlcXVpcmVkIjogWyJpZCJdCiAgICAgICAgfSwKICAgICAgICAiY29udGFpbmVyIjogdHJ1ZQogICAgfSkoQ1REeW5hRm9ybSkgfHwgQ1REeW5hRm9ybTsKICAgIHJldHVybiBDVER5bmFGb3JtOwp9KShIVE1MRWxlbWVudCk7Cgpkb2N1bWVudC5yZWdpc3RlckVsZW1lbnQoJ2N0LWR5bmEtZm9ybScsIENURHluYUZvcm0pOw==","type":"web-component-es2015","element":"ct-dyna-form","usage":"<ct-dyna-form></ct-dyna-form>","name":"CTDynaForm"}],"translation":{"default":"en_GB"},"metadata":{},"splashdata":{},"splash":"default"}